
================================================================================
–§–∞–π–ª: nobrain_bot\app.py
================================================================================
import asyncio
from aiogram import Bot, Dispatcher
from core.config import get_settings
from nobrain_bot.core.routers import setup_routers


async def main():
    config = get_settings()
    bot = Bot(token=config.bot_token)

    dp = Dispatcher()
    dp.include_router(setup_routers())

    await dp.start_polling(bot)


if __name__ == "__main__":
    asyncio.run(main())

================================================================================
–§–∞–π–ª: nobrain_bot\core\config.py
================================================================================
from dataclasses import dataclass
from dotenv import load_dotenv
import os

load_dotenv()


@dataclass
class Settings:
    bot_token: str
    admin_id: int
    site_url: str
    blog_url: str
    manager_url: str
    database_url: str


def get_settings() -> Settings:
    return Settings(
        bot_token=os.getenv("BOT_TOKEN", ""),
        admin_id=int(os.getenv("ADMIN_ID", "0")),
        site_url=os.getenv("SITE_URL", ""),
        blog_url=os.getenv("BLOG_URL", ""),
        manager_url=os.getenv("MANAGER_URL", ""),
        database_url=os.getenv(
            "DATABASE_URL",
            "postgresql+asyncpg://postgres:postgres@localhost:5432/nobrain"
        ),
    )


================================================================================
–§–∞–π–ª: nobrain_bot\core\routers.py
================================================================================
from aiogram import Router

from nobrain_bot.features.common.handlers.start_handler import router as start_router
from nobrain_bot.features.common.handlers.fallback_handler import router as fallback_router
from nobrain_bot.features.common.handlers.links_handlers import router as links_router
from nobrain_bot.features.temp_handler import router as temp_router

ALL_ROUTERS: tuple[Router, ...] = (
    start_router,
    links_router,
    temp_router,

    fallback_router
    )


def setup_routers() -> Router:
    """
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ—Ä–Ω–µ–≤–æ–π Router –∏ –≤–∫–ª—é—á–∞–µ—Ç –≤—Å–µ —Ä–æ—É—Ç–µ—Ä—ã –≤ –∑–∞–¥–∞–Ω–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ.
    """
    root = Router(name="root")
    for r in ALL_ROUTERS:
        root.include_router(r)
    return root


================================================================================
–§–∞–π–ª: nobrain_bot\database\session.py
================================================================================
from sqlalchemy.ext.asyncio import AsyncSession, create_async_engine
from sqlalchemy.orm import sessionmaker, declarative_base
from nobrain_bot.core.config import get_settings

settings = get_settings()

engine = create_async_engine(settings.database_url, echo=False)

async_session = sessionmaker[AsyncSession](
    bind=engine,
    class_=AsyncSession,
    expire_on_commit=False,
)

Base = declarative_base()


================================================================================
–§–∞–π–ª: nobrain_bot\database\__init__.py
================================================================================


================================================================================
–§–∞–π–ª: nobrain_bot\database\CRUD\order_crud.py
================================================================================
from sqlalchemy.ext.asyncio import AsyncSession
from sqlalchemy import select
from nobrain_bot.database.models.order import Order


# —Å–æ–∑–¥–∞—Ç—å –∑–∞—è–≤–∫—É
async def create_order(session: AsyncSession, tg_user_id, services, base_answers, details):
    # –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: —Å–∫–ª–∞–¥—ã–≤–∞–µ–º –≤—Å—ë –∫–∞–∫ –µ—Å—Ç—å. status = pending –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.
    order = Order(
        tg_user_id=tg_user_id,
        services=services,
        base_answers=base_answers,
        details=details,
    )
    session.add(order)
    await session.commit()
    await session.refresh(order)
    return order


# –ø–æ–ª—É—á–∏—Ç—å –∑–∞—è–≤–∫—É –ø–æ id
async def get_order_by_id(session: AsyncSession, order_id):
    result = await session.execute(select(Order).where(Order.id == order_id))
    return result.scalar_one_or_none()


# –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å (–∏ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –¥–∞—Ç—ã / –ø—Ä–∏—á–∏–Ω—É)
async def update_order_status(session: AsyncSession, order_id, status, start_date=None, end_date=None, decline_reason=None):
    result = await session.execute(select(Order).where(Order.id == order_id))
    order = result.scalar_one_or_none()
    if not order:
        return None

    order.status = status
    if start_date is not None:
        order.start_date = start_date
    if end_date is not None:
        order.end_date = end_date
    if decline_reason is not None:
        order.decline_reason = decline_reason

    await session.commit()
    await session.refresh(order)
    return order


# –≤—Å–µ –∑–∞—è–≤–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
async def get_orders_by_user(session: AsyncSession, tg_user_id):
    result = await session.execute(
        select(Order).where(Order.tg_user_id == tg_user_id).order_by(Order.created_at.desc())
    )
    return result.scalars().all()


================================================================================
–§–∞–π–ª: nobrain_bot\database\models\order.py
================================================================================
from datetime import datetime
from sqlalchemy import String, Text, DateTime, JSON, BigInteger, Integer
from sqlalchemy.orm import Mapped, mapped_column
from nobrain_bot.database.session import Base


class Order(Base):
    __tablename__ = "orders"

    # –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∑–∞—è–≤–∫–∏
    id: Mapped[int] = mapped_column(Integer, primary_key=True, autoincrement=True)

    # Telegram ID –∫–ª–∏–µ–Ω—Ç–∞
    tg_user_id: Mapped[int] = mapped_column(BigInteger, index=True, nullable=False)

    # –°–ø–∏—Å–æ–∫ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —É—Å–ª—É–≥ ‚Äî ["logo", "site", "bot", "content"]
    services: Mapped[list[str]] = mapped_column(JSON, nullable=False)

    # –ë–∞–∑–æ–≤—ã–µ –æ—Ç–≤–µ—Ç—ã (about, audience, goal, timing, budget)
    base_answers: Mapped[dict] = mapped_column(JSON, nullable=False)

    # –î–µ—Ç–∞–ª–∏ –ø–æ –∫–∞–∂–¥–æ–π —É—Å–ª—É–≥–µ (logo/site/bot/content)
    details: Mapped[dict] = mapped_column(JSON, nullable=False)

    # –°—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏: pending / accepted / declined
    status: Mapped[str] = mapped_column(String(20), default="pending", index=True)

    # –ü—Ä–∏—á–∏–Ω–∞ –æ—Ç–∫–∞–∑–∞ (–µ—Å–ª–∏ declined)
    decline_reason: Mapped[str | None] = mapped_column(Text)

    # –î–∞—Ç—ã –Ω–∞—á–∞–ª–∞ –∏ –æ–∫–æ–Ω—á–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    start_date: Mapped[datetime | None] = mapped_column(DateTime)
    end_date: Mapped[datetime | None] = mapped_column(DateTime)

    # –¢–∞–π–º—Å—Ç–µ–º–ø—ã
    created_at: Mapped[datetime] = mapped_column(DateTime, default=datetime.utcnow)
    updated_at: Mapped[datetime] = mapped_column(DateTime, default=datetime.utcnow, onupdate=datetime.utcnow)


================================================================================
–§–∞–π–ª: nobrain_bot\features\temp_handler.py
================================================================================
from aiogram import F, Router
from aiogram.types import Message

router = Router(name='temp_router')

@router.message(F.video)
async def get_video_id(message: Message):
    await message.answer(f"ID video: {message.video.file_id}")

================================================================================
–§–∞–π–ª: nobrain_bot\features\common\texts.py
================================================================================
def welcome(name: str) -> str:
    return (
        f"–ô–æ, {name or '–¥—Ä—É–≥'}! ‚úåÔ∏è\n\n"
        "–¢—ã –≤ –±–æ—Ç–µ —Å—Ç—É–¥–∏–∏ üß† `nobrain_production`\n"
        "üåå –ú—ã –ø—Ä–µ–≤—Ä–∞—â–∞–µ–º –∏–¥–µ–∏ –≤ –ø—Ä–æ–¥—É–∫—Ç—ã\n\n"
        "–•–æ—á–µ—à—å —É–∑–Ω–∞—Ç—å –æ –Ω–∞—Å, –≥–ª—è–Ω—É—Ç—å —É—Å–ª—É–≥–∏ –∏–ª–∏ —Å—Ä–∞–∑—É –æ—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑‚ùì\n\n"
        "üëá –í—Å—ë —á–µ—Ä–µ–∑ –º–µ–Ω—é –Ω–∏–∂–µ."
    )


ABOUT_TEXT = (
    "üß† `nobrain_production` ‚Äî —Å—Ç—É–¥–∏—è, –≥–¥–µ –∫—Ä–µ–∞—Ç–∏–≤ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è —Å —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è–º–∏.\n\n"
    "–ú—ã —Å–æ–∑–¥–∞—ë–º –ø—Ä–æ–¥—É–∫—Ç—ã üõç: –ª–æ–≥–æ—Ç–∏–ø—ã, —Ç–µ–∫—Å—Ç—ã, —Å–∞–π—Ç—ã-–≤–∏–∑–∏—Ç–∫–∏, Telegram-–±–æ—Ç—ã.\n\n"
    "–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –Ω–∞ —Å–∞–π—Ç–µ –ø–æ —Å—Å—ã–ª–∫–µ –Ω–∏–∂–µ üëá"
)

BLOG_TEXT = (
    "üì≤ –ó–∞—á–µ–º –±–∏–∑–Ω–µ—Å—É –≤ Telegram?\n"
    "üé® –ö–∞–∫ —Å—Ç–∏–ª—å –≤–ª–∏—è–µ—Ç –Ω–∞ –ø—Ä–æ–¥–∞–∂–∏?\n"
    "‚úçÔ∏è –ò –ø–æ—á–µ–º—É —Ç–µ–∫—Å—Ç —Ä–µ—à–∞–µ—Ç?\n\n"
    "–†–∞—Å—Å–∫–∞–∑—ã–≤–∞–µ–º –≤ –Ω–∞—à–µ–º –±–ª–æ–≥–µ üëá"
)

MANAGER_TEXT = "–ï—Å—Ç—å –º—ã—Å–ª—å, –∑–∞–¥–∞—á–∞ –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ –≤–æ–ø—Ä–æ—Å‚ùì\n\n–ù–∞–ø–∏—à–∏ –º–µ–Ω–µ–¥–∂–µ—Ä—É üëá"




================================================================================
–§–∞–π–ª: nobrain_bot\features\common\handlers\fallback_handler.py
================================================================================
from aiogram import Router
from aiogram.types import Message

from nobrain_bot.features.common.keyboards.main_menu_keyboard import main_menu_kb

router = Router(name="fallback")


@router.message()
async def fallback(message: Message):
    await message.answer(
        text=(
            "üòï –Ø —Ç–µ–±—è –Ω–µ –ø–æ–Ω—è–ª.\n"
            "–í—ã–±–µ—Ä–∏ –¥–µ–π—Å—Ç–≤–∏–µ —á–µ—Ä–µ–∑ –º–µ–Ω—é –Ω–∏–∂–µ üëá"
        ),
        reply_markup=main_menu_kb()
    )


================================================================================
–§–∞–π–ª: nobrain_bot\features\common\handlers\links_handlers.py
================================================================================
from aiogram import Router, F
from aiogram.types import Message, InlineKeyboardMarkup, InlineKeyboardButton
from nobrain_bot.core.config import get_settings
from nobrain_bot.features.common.keyboards.links_kb import about_kb, blog_kb, manager_kb
from nobrain_bot.features.common.texts import ABOUT_TEXT, BLOG_TEXT, MANAGER_TEXT

router = Router(name="liks")


@router.message(F.text == "üß† –ß—Ç–æ —Ç–∞–∫–æ–µ nobrain_production?")
async def about_handler(message: Message):
    config = get_settings()
    await message.answer(text=ABOUT_TEXT, reply_markup=about_kb(config), parse_mode='Markdown')


@router.message(F.text == "üì∞ –ù–∞—à –±–ª–æ–≥")
async def blog_handler(message: Message):
    config = get_settings()
    await message.answer(text=BLOG_TEXT, reply_markup=blog_kb(config))


@router.message(F.text == "üì± –°–≤—è–∑–∞—Ç—å—Å—è —Å –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º")
async def manager_handler(message: Message):
    config = get_settings()
    await message.answer(text=MANAGER_TEXT, reply_markup=manager_kb(config))

================================================================================
–§–∞–π–ª: nobrain_bot\features\common\handlers\start_handler.py
================================================================================
from aiogram import Router, F
from aiogram.filters import CommandStart
from aiogram.types import Message

from nobrain_bot.features.common.texts import welcome
from nobrain_bot.features.common.keyboards.main_menu_keyboard import main_menu_kb


router = Router(name="start")


@router.message(F.text == '/start')
async def cmd_start(message: Message):
    await message.answer(text=welcome(message.from_user.first_name), parse_mode='Markdown', reply_markup=main_menu_kb())

================================================================================
–§–∞–π–ª: nobrain_bot\features\common\keyboards\links_kb.py
================================================================================
from aiogram.types import InlineKeyboardMarkup, InlineKeyboardButton


def about_kb(config) -> InlineKeyboardMarkup:
    kb = [
        [InlineKeyboardButton(text="üåê –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Å–∞–π—Ç", url=config.site_url)]
    ]
    return InlineKeyboardMarkup(inline_keyboard=kb)


def blog_kb(config) -> InlineKeyboardMarkup:
    kb = [
        [InlineKeyboardButton(text="üìñ –û—Ç–∫—Ä—ã—Ç—å –±–ª–æ–≥", url=config.blog_url)]
    ]
    return InlineKeyboardMarkup(inline_keyboard=kb)


def manager_kb(config) -> InlineKeyboardMarkup:
    kb = [
        [InlineKeyboardButton(text="üì± –ù–∞–ø–∏—Å–∞—Ç—å –º–µ–Ω–µ–¥–∂–µ—Ä—É", url=config.manager_url)]
    ]
    return InlineKeyboardMarkup(inline_keyboard=kb)


================================================================================
–§–∞–π–ª: nobrain_bot\features\common\keyboards\main_menu_keyboard.py
================================================================================
from aiogram.types import KeyboardButton, ReplyKeyboardMarkup


def main_menu_kb() -> ReplyKeyboardMarkup:
    kb = [
        [KeyboardButton(text="üß† –ß—Ç–æ —Ç–∞–∫–æ–µ nobrain_production?")],
        [KeyboardButton(text="üíº –í–∏—Ç—Ä–∏–Ω–∞ —É—Å–ª—É–≥")],
        [KeyboardButton(text="üìù –°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑")],
        [KeyboardButton(text="üì± –°–≤—è–∑–∞—Ç—å—Å—è —Å –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º")],
        [ KeyboardButton(text="üì∞ –ù–∞—à –±–ª–æ–≥")]
    ]
    return ReplyKeyboardMarkup(
        keyboard=kb,
        resize_keyboard=True,
        input_field_placeholder="–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ"
    )


================================================================================
–§–∞–π–ª: nobrain_bot\features\order\states.py
================================================================================
from aiogram.fsm.state import StatesGroup, State


class OrderFSM(StatesGroup):
    entry = State()
    formality = State()
    classic_modern = State()
    serious_fun = State()
    speed_quality = State()
    rational_emotional = State()
    values = State()
    project_types = State()
    spec_text = State()
    budget_band = State()
    deadline_pref = State()
    review = State()


================================================================================
–§–∞–π–ª: nobrain_bot\features\order\texts.py
================================================================================

